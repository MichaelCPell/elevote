<% content_for :leftColumn do %>

    <h1>Support</h1>

    <% if current_official %>
        <% unless current_official.opinions.exists?(:legislation_id => @legislation.id) %>
            <%= form_for (Opinion.new) do |f| %>
               <%= f.hidden_field :status, :value => "support"  %>
               <%= f.hidden_field :official_id, :value => current_official.id %>
               <%= f.hidden_field :legislation_id, :value => @legislation.id %>
               <%= f.submit "Support This Legislation"  %>
            <% end %>
        <% end %>
    <% end %>

    <div class="officialOpinion span-3">
        <% for opinion in @legislation.opinions.support %>
            <div class="officialOpinionThumb span-2"><%= link_to officials_full_name(Official.find_by_id(opinion.official_id)), Official.find_by_id(opinion.official_id) %></div>
        <% end %>
    </div>
<% end %>




<% content_for :middleColumn do %>

         <h1><%= @legislation.name %></h1>
        <%= link_to "Vote for This", vote_legislation_path(@legislation), :method => :post %>

           <br>
    <div id="tabs" class="span-14">
         <ul>
           <li><%= link_to("Legislation Info", "#legislationInfo")%></li>
           <li><%= link_to("Support", "#support") %></li>
           <li><%= link_to("Oppose", "#oppose") %></li>
         </ul>

        <div id="legislationInfo" class="questionsPanel span-14 last">
            <%= @legislation.content %>
        </div>

        <div id="support" class="questionsPanel span-14 last">
            <% for comment in @legislation.comments do %>

                <% if comment.direction == "support" %>

                     <div id="commentVotes" class="span-4">
                         <%= pluralize comment.votes.count, 'vote', 'votes' %>
                    </div>

                  <div id ="comment" class="span-10 last">
                        <% if comment.id %>
                            <%= link_to comment.content, comment %>
                        <% end %>
                    </div>


                <% end %>
            <% end %>



            <%= link_to 'New Comment', new_legislation_comment_path(@legislation, :direction => "support") %>
        </div>

        <div id="oppose" class="questionsPanel span-14 last">


        <% for comment in @legislation.comments do %>
            <% if comment.direction == "oppose" %>
                <div id="commentVotes" class="span-4">
                    <%= pluralize comment.votes.count, 'vote', 'votes' %>
                </div>

                <div id ="comment" class="span-10 last">
                    <% if comment.id %>
                        <%= link_to comment.content, comment %>
                    <% end %>
                </div>
            <% end %>
        <% end %>

        <%= link_to 'New Comment', new_legislation_comment_path(@legislation, :direction => "support") %>

        </div>

    </div> <!-- end tabs -->
<% end %>



<% content_for :rightColumn do %>
    <h1>Oppose</h1>



    <% if current_official %>

    <% unless current_official.opinions.exists?(:legislation_id => @legislation.id) %>
        <%= form_for (Opinion.new) do |f| %>
           <%= f.hidden_field :status, :value => "oppose"  %>
           <%= f.hidden_field :official_id, :value => current_official.id %>
           <%= f.hidden_field :legislation_id, :value => @legislation.id %>
           <%= f.submit "Oppose This Legislation"  %>
        <% end %>
    <% end %>

    <% end %>

    <div class="officialOpinion span-3">
        <% for opinion in @legislation.opinions.oppose %>
              <div class="officialOpinionThumb span-2"><%= Official.find_by_id(opinion.official_id).firstname %></div>
        <% end %>
    </div>
<% end %>